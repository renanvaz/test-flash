  package {	import flash.display.MovieClip;	import flash.media.Microphone;	import flash.system.Security;	import flash.events.ActivityEvent;    import flash.events.SampleDataEvent;    import flash.utils.ByteArray;    import flash.media.SoundMixer;    import flash.display.Graphics;	public class Test extends MovieClip {        public const SAMPLING_RATE:int  = 44100;        public const SAMPLES:int        = 2048;        public const REPEAT:int         = 5;        private var last:int             = 0;        private var start:Boolean        = false;        private var mic:Microphone;		public function Test(): void        {            mic = Microphone.getMicrophone();            mic.rate = SAMPLING_RATE/1000; // 44100Hz, Default 8            mic.setLoopBack(true);            mic.setSilenceLevel(1, 0);            mic.setUseEchoSuppression(false);            mic.addEventListener(SampleDataEvent.SAMPLE_DATA, onSampleData);		}        private function onSampleData (event:SampleDataEvent): void        {            var hz:int = 0;            var bytes = event.data;            var g:Graphics = this.graphics;            var current:int = 0;            for (var i:int = 0; i < 2048; i++) {                current = bytes.readFloat() > 0 ? 1 : 0;                if (current != last) {                    last = current;                    hz++;                }                if (i > 0 && i % 256 === 0) {                    trace(hz);                    // trace(String.fromCharCode(this.hzToAscii(hz/2)));                    hz = current = last = 0;                }            }            hz = hz/2;            //trace(String.fromCharCode(this.hzToAscii(hz)));            /*g.clear();            g.lineStyle(0, 0x6600CC);            g.beginFill(0x6600CC);            g.moveTo(0, PLOT_HEIGHT);            var n:Number = 0;            // left channel            for (var i:int = 0; i < CHANNEL_LENGTH; i++) {                n = (bytes.readFloat() * PLOT_HEIGHT);                g.lineTo((i / CHANNEL_LENGTH) * stage.stageWidth, PLOT_HEIGHT - n);            }            g.lineTo(CHANNEL_LENGTH * 2, PLOT_HEIGHT);            g.endFill();            // right channel            g.lineStyle(0, 0xCC0066);            g.beginFill(0xCC0066, 0.5);            g.moveTo(0, PLOT_HEIGHT);            for (i = 0; i < CHANNEL_LENGTH; i++) {                n = (bytes.readFloat() * PLOT_HEIGHT);                g.lineTo((i / CHANNEL_LENGTH) * stage.stageWidth, PLOT_HEIGHT - n);            }            g.lineTo(CHANNEL_LENGTH * 2, PLOT_HEIGHT);            g.endFill();*/        }        public function charToAscii(c): int        {            return Math.round((c.charCodeAt(0) - 32) * 44100/2048);        }        public function hzToAscii(h): int        {            return Math.round(Math.round(h) / 10) + 32;        }	}}